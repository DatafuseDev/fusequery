[package]
description = "Arrow implementation forked from arrow2 and native format implementation forked from strawboat."
edition = "2021"
license = "Apache-2.0"
name = "databend-common-arrow"
publish = false
version = "0.1.0"

[lib]
doctest = false
test = true

[features]
default = ["arrow-default"]

arrow = ["arrow-buffer", "arrow-schema", "arrow-data", "arrow-array"]
io_flight = ["io_ipc", "arrow-format/flight-data"]
io_ipc = []
io_ipc_compression = []

# sample testing of generated arrow data

compute = [
    "compute_aggregate",
    "compute_cast",
    "compute_concatenate",
    "compute_merge_sort",
    "compute_sort",
    "compute_take",
]
compute_aggregate = []
compute_cast = ["lexical-core", "compute_take"]
compute_concatenate = []
compute_merge_sort = ["itertools", "compute_sort"]
compute_sort = ["compute_take"]
compute_take = []

serde_types = ["serde", "serde_derive"]
simd = []

arrow-default = [
    "arrow",
    "io_ipc",
    "io_ipc_compression",
    "io_flight",
    "compute",
    "serde_types",
    "simd",
]


[dependencies]
ahash = { workspace = true }
arrow-array = { workspace = true, optional = true }
arrow-buffer = { workspace = true, optional = true }
arrow-data = { workspace = true, optional = true }
arrow-format = { workspace = true }
arrow-schema = { workspace = true, optional = true }
async-stream = { workspace = true, optional = true }
base64 = { workspace = true, optional = true }
bitpacking = { workspace = true }
bytemuck = { workspace = true }
byteorder = { workspace = true }
bytes = { workspace = true }
chrono = { workspace = true }
chrono-tz = { workspace = true, optional = true }
dyn-clone = { workspace = true }
either = { workspace = true }
ethnum = { workspace = true }
fallible-streaming-iterator = { workspace = true, optional = true }
foreign_vec = { workspace = true }
futures = { workspace = true, optional = true }
hashbrown_v0_14 = { workspace = true }
indexmap = { workspace = true }
itertools = { workspace = true, optional = true }
lexical-core = { workspace = true, optional = true }
log = { workspace = true }
lz4 = { workspace = true }
num = { workspace = true, features = ["std"] }
num-traits = { workspace = true }
serde_json = { workspace = true }
opendal = { workspace = true }
ordered-float = { workspace = true }
rand = { workspace = true }
ringbuffer = { workspace = true }
roaring = { workspace = true }
serde = { workspace = true, features = ["rc"], optional = true }
serde_derive = { workspace = true, optional = true }
simdutf8 = { workspace = true }
snap = { workspace = true }
streaming-iterator = { workspace = true, optional = true }
zstd = { workspace = true }

[dev-dependencies]
# used to test async readers
env_logger = { workspace = true }
flate2 = { workspace = true }
proptest = { workspace = true, default-features = false, features = ["std"] }
quanta = { workspace = true }
tokio = { workspace = true, features = ["macros", "rt", "fs", "io-util"] }
tokio-util = { workspace = true, features = ["compat"] }

[lints]
workspace = true
