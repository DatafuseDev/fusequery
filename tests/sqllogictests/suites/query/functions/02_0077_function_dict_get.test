statement ok
create or replace table t(a string)

statement ok
insert into t values('a'),('b'),('%c')

statement ok
CREATE OR REPLACE DICTIONARY d(key string not null, value string not null) PRIMARY KEY key SOURCE(redis(host='127.0.0.1' port='6379'))

query T
select a, dict_get(d, 'value', a) from t
----
a a_value
b b_value
%c (empty)

query T
SELECT dict_get(d, 'value', 'b')
----
b_value

statement error 1006
select dict_get(d, 'value11', 'a')

statement error 3114
select dict_get(test, 'value', 'b')

query T
SELECT dict_get(d, 'value', 1)
----
1_value

statement ok
CREATE OR REPLACE TABLE default.t(a string, b string)

statement ok
CREATE OR REPLACE DICTIONARY d2(key string not null, value string not null) PRIMARY KEY key SOURCE(mysql(host='127.0.0.1' port='3308' username='root' password='1234' db='default' table='t'))

statement ok
insert into t values('key1','value1'),('key2','value2'),('key3','value3')

query T
SELECT dict_get(d2, 'value', 'a')
----
