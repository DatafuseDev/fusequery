statement ok
set join_spilling_memory_ratio = 1;

statement ok
set join_spilling_bytes_threshold_per_proc = 1;

statement ok
set join_spilling_buffer_threshold_per_proc_mb = 1;

statement ok
create or replace table t1 as select number as a from numbers(10);

statement ok
create or replace table t2 as select number as a from numbers(1);

# LEFT OUTER JOIN
query I
select * from t1 left join t2 on t1.a = t2.a;
----
1 NULL
2 NULL
8 NULL
4 NULL
6 NULL
5 NULL
7 NULL
9 NULL
0 0
3 NULL

# LEFT ANTI JOIN
query I
select * from t1 where not exists(select * from t2 where t1.a = t2.a);
----
1
2
8
4
6
5
7
9
3

statement ok
insert into t2 select number as a from numbers(20);

# FULL OUTER JOIN
query I
select * from t1 full outer join t2 on t1.a = t2.a;
----
2 2
NULL 18
7 7
5 5
NULL 13
NULL 16
0 0
0 0
3 3
NULL 14
NULL 15
NULL 17
1 1
4 4
NULL 11
NULL 12
9 9
6 6
NULL 19
NULL 10
8 8

statement ok
drop table if exists t1;

statement ok
drop table if exists t2;
