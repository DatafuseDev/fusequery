statement ok
drop table if exists a;

statement ok
drop table if exists b;

statement ok
create table a (a_id int, a_val int);

statement ok
create table b (b_id int, b_val int, a_id int);

statement ok
insert into a (a_id, a_val) values (1, 10), (1, 100), (2, 20), (3, 30), (4, 40), (5, 50);

statement ok
insert into b (b_id, b_val, a_id) values (1, 100, 1), (2, 200, 1), (3, 300, 2), (4, 400, 2), (5, 500, 2), (6, 600, 3), (7, 700, 3), (8, 800, 3), (9, 900, 4), (10, 1000, 4), (11, 1100, 4), (12, 1200, 4), (13, 1300, 5), (14, 1400, 5), (15, 1500, 5), (16, 1600, 5), (17, 1700, 1), (18, 1800, 2), (19, 1900, 3), (20, 2000, 4);

# eager group-by
query T
select b.a_id, sum(b.b_val), count(b.b_val), avg(b.b_val), min(b.b_val), max(b.b_val) from a join b on a.a_id = b.a_id group by b.a_id order by b.a_id;
----
1 4000 6 666.6666666666666 100 1700
2 3000 4 750.0 300 1800
3 4000 4 1000.0 600 1900
4 6200 5 1240.0 900 2000
5 5800 4 1450.0 1300 1600

# eager count and double eager
query T
select a.a_id, b.a_id, sum(b.b_val) from a join b on a.a_id = b.a_id group by a.a_id, b.a_id order by b.a_id;
----
1 1 4000
2 2 3000
3 3 4000
4 4 6200
5 5 5800