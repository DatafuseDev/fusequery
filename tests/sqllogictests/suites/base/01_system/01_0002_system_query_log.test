query I
select * from numbers(100) where number > 95
----
96
97
98
99

query B
select count(*) > 0 from system.query_log
----
1

statement ok
drop table if exists tbl_01_0002 all

statement ok
create table tbl_01_0002(a int)

statement ok
insert into  tbl_01_0002 values(1)

# TODO sometimes get empty result
# query I
# select written_rows from system.query_log where query_text='insert into  tbl_01_0002 values(1)' and written_rows != 0

# ----
# 1

statement ok
insert into  tbl_01_0002 values(2)

query I
select count(*) from tbl_01_0002 where a > 1
----
1

# TODO sometimes get 0 here
# query I
# select count(1) from system.query_log where query_text='select count(*) from tbl_01_0002 where a > 1' and scan_partitions = 1 and total_partitions = 2

# ----
# 1

statement ok
drop table tbl_01_0002

statement ok
drop table if exists t1;

statement ok
drop table if exists t2;

# runtiem filter prune query log
statement ok
create table t1(a int) as select number from numbers(100);

statement ok
create table t2(a int) as select number from numbers(1000000);

query I
select count() from t1, t2 where t1.a = t2.a;
----
100

# check if runtime filter prune rows > 0. If so, runtime filter prune works
query I
SELECT
    CASE
        WHEN COUNT(*) > 0 THEN 1
        ELSE 0
    END
FROM
    system.query_log
WHERE
    runtime_filter_prune_rows > 0;
----
1

statement ok
drop table t1

statement ok
drop table t2
