statement ok
DROP NETWORK POLICY IF EXISTS test_policy

statement ok
DROP NETWORK POLICY IF EXISTS test_policy1

statement error 2207
DROP NETWORK POLICY test_policy

statement ok
CREATE NETWORK POLICY test_policy ALLOWED_IP_LIST=('192.168.1.0/24') BLOCKED_IP_LIST=('192.168.1.99') COMMENT='test comment'

query TTTT
DESC NETWORK POLICY test_policy
----
test_policy 192.168.1.0/24 192.168.1.99 test comment

statement ok
CREATE NETWORK POLICY test_policy1 ALLOWED_IP_LIST=('192.168.100.0/24')

query TTTT
SHOW NETWORK POLICIES
----
test_policy 192.168.1.0/24 192.168.1.99 test comment
test_policy1 192.168.100.0/24 (empty) (empty)

statement ok
ALTER NETWORK POLICY test_policy SET BLOCKED_IP_LIST=('192.168.1.10')

query TTTT
DESC NETWORK POLICY test_policy
----
test_policy 192.168.1.0/24 192.168.1.10 test comment

statement ok
ALTER NETWORK POLICY test_policy SET ALLOWED_IP_LIST=('192.168.10.0', '192.168.20.0') BLOCKED_IP_LIST=() COMMENT='new comment'

query TTTT
DESC NETWORK POLICY test_policy
----
test_policy 192.168.10.0,192.168.20.0 (empty) new comment

statement ok
DROP NETWORK POLICY test_policy

statement error 2207
DROP NETWORK POLICY test_policy

statement error 2207
DESC NETWORK POLICY test_policy
