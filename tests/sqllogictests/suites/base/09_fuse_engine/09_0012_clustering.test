statement ok
DROP DATABASE IF EXISTS db_09_0012

statement ok
CREATE DATABASE db_09_0012

statement ok
USE db_09_0012

statement ok
CREATE TABLE t1(a int, b int) cluster by(a,b) row_per_block = 2;

statement ok
INSERT INTO t1 VALUES(1, 1), (1, 2);

statement ok
INSERT INTO t1 VALUES(2, 1), (2, 2);

statement ok
ALTER TABLE t1 RECLUSTER FINAL;

query TTIIFFT
select * exclude(timestamp) from clustering_information('db_09_0012','t1')
----
(a, b) linear 2 0 0.0 1.0 {"00001":2}

query T
EXPLAIN SELECT * FROM t1 WHERE a = 1;
----
Filter
├── output columns: [t1.a (#0), t1.b (#1)]
├── filters: [is_true(t1.a (#0) = 1)]
├── estimated rows: 2.00
└── TableScan
    ├── table: default.db_09_0012.t1
    ├── output columns: [a (#0), b (#1)]
    ├── read rows: 2
    ├── read size: < 1 KiB
    ├── partitions total: 2
    ├── partitions scanned: 1
    ├── pruning stats: [segments: <range pruning: 1 to 1>, blocks: <range pruning: 2 to 1, bloom pruning: 1 to 1>]
    ├── push downs: [filters: [is_true(t1.a (#0) = 1)], limit: NONE]
    └── estimated rows: 4.00

query T
EXPLAIN SELECT * FROM t1 WHERE b = 1;
----
Filter
├── output columns: [t1.a (#0), t1.b (#1)]
├── filters: [is_true(t1.b (#1) = 1)]
├── estimated rows: 2.00
└── TableScan
    ├── table: default.db_09_0012.t1
    ├── output columns: [a (#0), b (#1)]
    ├── read rows: 4
    ├── read size: < 1 KiB
    ├── partitions total: 2
    ├── partitions scanned: 2
    ├── pruning stats: [segments: <range pruning: 1 to 1>, blocks: <range pruning: 2 to 2, bloom pruning: 2 to 2>]
    ├── push downs: [filters: [is_true(t1.b (#1) = 1)], limit: NONE]
    └── estimated rows: 4.00

statement ok
CREATE TABLE t2(a int, b int) cluster by hilbert(a,b) row_per_block = 2;

statement ok
INSERT INTO t2 VALUES(1, 1), (1, 2);

statement ok
INSERT INTO t2 VALUES(2, 1), (2, 2);

statement ok
ALTER TABLE t2 RECLUSTER FINAL;

query TTIIFFT
select * exclude(timestamp) from clustering_information('db_09_0012','t2')
----
(a, b) hilbert 2 0 0.0 1.0 {"00001":2}

query T
EXPLAIN SELECT * FROM t2 WHERE a = 1;
----
Filter
├── output columns: [t2.a (#0), t2.b (#1)]
├── filters: [is_true(t2.a (#0) = 1)]
├── estimated rows: 2.00
└── TableScan
    ├── table: default.db_09_0012.t2
    ├── output columns: [a (#0), b (#1)]
    ├── read rows: 4
    ├── read size: < 1 KiB
    ├── partitions total: 2
    ├── partitions scanned: 2
    ├── pruning stats: [segments: <range pruning: 1 to 1>, blocks: <range pruning: 2 to 2, bloom pruning: 2 to 2>]
    ├── push downs: [filters: [is_true(t2.a (#0) = 1)], limit: NONE]
    └── estimated rows: 4.00

query T
EXPLAIN SELECT * FROM t2 WHERE b = 1;
----
Filter
├── output columns: [t2.a (#0), t2.b (#1)]
├── filters: [is_true(t2.b (#1) = 1)]
├── estimated rows: 2.00
└── TableScan
    ├── table: default.db_09_0012.t2
    ├── output columns: [a (#0), b (#1)]
    ├── read rows: 2
    ├── read size: < 1 KiB
    ├── partitions total: 2
    ├── partitions scanned: 1
    ├── pruning stats: [segments: <range pruning: 1 to 1>, blocks: <range pruning: 2 to 1, bloom pruning: 1 to 1>]
    ├── push downs: [filters: [is_true(t2.b (#1) = 1)], limit: NONE]
    └── estimated rows: 4.00

statement ok
DROP TABLE t1 ALL;

statement ok
DROP TABLE t2 ALL;

statement ok
DROP DATABASE db_09_0012;
