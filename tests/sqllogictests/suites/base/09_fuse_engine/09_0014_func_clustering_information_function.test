statement ok
use default

statement ok
create table t09_0014(a int, b int) cluster by(b,a)

statement ok
insert into t09_0014 values(0,3),(1,1)

statement ok
insert into t09_0014 values(1,3),(2,1)

statement ok
insert into t09_0014 values(4,4)

query II
select *  from t09_0014 order by b, a
----
1 1
2 1
0 3
1 3
4 4

query TIIFFT
select * exclude(timestamp) from clustering_information('default','t09_0014')
----
(b, a) 3 1 0.6667 1.6667 {"00001":1,"00002":2}

query TIIFFT
select * exclude(timestamp) from clustering_information('default','t09_0014', '(a)')
----
(a) 3 1 0.6667 1.6667 {"00001":1,"00002":2}

statement ok
ALTER TABLE t09_0014 DROP CLUSTER KEY

statement error 1118
select * from clustering_information('default','t09_0014')

query TIIFFT
select * exclude(timestamp) from clustering_information('default','t09_0014', '(b, a)')
----
(b, a) 3 1 0.6667 1.6667 {"00001":1,"00002":2}

statement ok
drop table t09_0014

statement ok
create table t09_0014_1(c string)

statement ok
insert into t09_0014_1 values ('abc'), ('abd')

statement ok
insert into t09_0014_1 values ('xyy'), ('xyz')

query TIIFFT
select * exclude(timestamp) from clustering_information('default','t09_0014_1', '(c)')
----
(c) 2 0 0.0 1.0 {"00001":2}

query TIIFFT
select * exclude(timestamp) from clustering_information('default','t09_0014_1', '(substr(c,1))')
----
(SUBSTRING(c FROM 1)) 2 0 0.0 1.0 {"00001":2}

query TIIFFT
select * exclude(timestamp) from clustering_information('default','t09_0014_1', '(substr(c,1,2))')
----
(SUBSTRING(c FROM 1 FOR 2)) 2 2 0.0 1.0 {"00001":2}

query TIIFFT
select * exclude(timestamp) from clustering_information('default','t09_0014_1', '(substr(c,2,2))')
----
(SUBSTRING(c FROM 2 FOR 2)) 2 0 1.0 2.0 {"00002":2}

query T
explain select * from t09_0014_1 where left(c, 2) = 'ab'
----
Filter
├── output columns: [t09_0014_1.c (#0)]
├── filters: [is_true(left(t09_0014_1.c (#0), 2) = 'ab')]
├── estimated rows: 0.80
└── TableScan
    ├── table: default.default.t09_0014_1
    ├── output columns: [c (#0)]
    ├── read rows: 2
    ├── read size: < 1 KiB
    ├── partitions total: 2
    ├── partitions scanned: 1
    ├── pruning stats: [segments: <range pruning: 2 to 1>, blocks: <range pruning: 1 to 1>]
    ├── push downs: [filters: [is_true(left(t09_0014_1.c (#0), 2) = 'ab')], limit: NONE]
    └── estimated rows: 4.00

statement ok
drop table t09_0014_1
