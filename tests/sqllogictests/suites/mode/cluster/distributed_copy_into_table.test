statement ok
create stage st FILE_FORMAT = (TYPE = CSV);

statement ok
create table table_random(a int,b string,c string) ENGINE = Random;

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
create table t(a int,b string,c string);

query T
explain pipeline copy into t from @st force = true;
----
 MutationSink × 1 processor
   MutationAggregator × 1 processor
     Merge (TransformExchangeDeserializer × 10 processors) to (MutationAggregator × 1)
       TransformExchangeDeserializer × 10 processors
         Merge (DummyTransform × 12 processors) to (TransformExchangeDeserializer × 10)
           Merge (AppendTransform × 10 processors) to (Resize × 12)
             AppendTransform × 10 processors
               Merge (BlockCompactTransform × 1 processor) to (AppendTransform × 10)
                 BlockCompactTransform × 1 processor
                   Merge (DeserializeTransformer × 10 processors) to (BlockCompactTransform × 1)
                     DeserializeTransformer × 10 processors
                       Merge (Aligner × 3 processors) to (DeserializeTransformer × 10)
                         Aligner × 3 processors

statement ok
copy into t from @st force = true;

query I
select count(*) from t;
----
8000000

statement ok
copy into t from @st force = true;

query I
select count(*) from t;
----
16000000


