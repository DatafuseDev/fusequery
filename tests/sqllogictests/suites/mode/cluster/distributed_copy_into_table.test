statement ok
create stage st FILE_FORMAT = (TYPE = CSV);

statement ok
create table table_random(a int,b string,c string) ENGINE = Random;

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
copy into @st from (select a,b,c from table_random limit 1000000);

statement ok
create table t(a int,b string,c string);

query T
explain pipeline copy into t from @st force = true;
----
MutationAggregator × 1 processor
  Merge (TransformExchangeDeserializer × 6 processors) to (MutationAggregator × 1)
    TransformExchangeDeserializer × 6 processors
      Merge (DummyTransform × 8 processors) to (TransformExchangeDeserializer × 6)
        Merge (AppendTransform × 6 processors) to (Resize × 8)
          AppendTransform × 6 processors
            Merge (BlockCompactTransform × 1 processor) to (AppendTransform × 6)
              BlockCompactTransform × 1 processor
                Merge (DeserializeTransformer × 6 processors) to (BlockCompactTransform × 1)
                  DeserializeTransformer × 6 processors
                    Aligner × 6 processors

statement ok
copy into t from @st force = true;

query I
select count(*) from t;
----
8000000

statement ok
copy into t from @st force = true;

query I
select count(*) from t;
----
16000000


