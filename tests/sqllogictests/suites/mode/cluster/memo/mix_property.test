statement ok
drop database if exists mix_property

statement ok
create database mix_property

statement ok
use mix_property

statement ok
set max_threads = 1

statement ok
create table t_10(a int) as select * from numbers(10)

statement ok
create table t_100(a int) as select * from numbers(100)

statement ok
create table t_1000(a int) as select * from numbers(1000)

query error mysql client error: Server error: `ERROR HY000 \(1105\): Internal\. Code: 1001, Text = Cannot find best cost of group: 10\.'
explain memo
select sum(t_1000.a) from t_1000, t_100, t_10
where t_1000.a = t_100.a and t_1000.a = t_10.a
group by t_100.a, t_10.a
order by t_100.a, t_10.a
limit 10


statement ok
drop database mix_property
