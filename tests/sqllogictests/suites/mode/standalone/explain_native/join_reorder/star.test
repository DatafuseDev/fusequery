statement ok
drop database if exists join_reorder

statement ok
create database join_reorder

statement ok
use join_reorder

statement ok
create table t as select number as a from numbers(1)

statement ok
create table t1 as select number as a from numbers(10)

statement ok
create table t2 as select number as a from numbers(100)

query T
explain join select * from t, t1, t2 where t.a = t2.a and t1.a = t2.a
----
HashJoin: INNER
├── Build
│   └── HashJoin: INNER
│       ├── Build
│       │   └── Scan: default.join_reorder.t (read rows: 1)
│       └── Probe
│           └── Scan: default.join_reorder.t1 (read rows: 10)
└── Probe
    └── Scan: default.join_reorder.t2 (read rows: 100)

query T
explain join select * from t, t2, t1 where t.a = t2.a and t1.a = t2.a
----
HashJoin: INNER
├── Build
│   └── HashJoin: INNER
│       ├── Build
│       │   └── Scan: default.join_reorder.t (read rows: 1)
│       └── Probe
│           └── Scan: default.join_reorder.t1 (read rows: 10)
└── Probe
    └── Scan: default.join_reorder.t2 (read rows: 100)

query T
explain join select * from t1, t, t2 where t.a = t2.a and t1.a = t2.a
----
HashJoin: INNER
├── Build
│   └── HashJoin: INNER
│       ├── Build
│       │   └── Scan: default.join_reorder.t (read rows: 1)
│       └── Probe
│           └── Scan: default.join_reorder.t1 (read rows: 10)
└── Probe
    └── Scan: default.join_reorder.t2 (read rows: 100)

query T
explain join select * from t1, t2, t where t.a = t2.a and t1.a = t2.a
----
HashJoin: INNER
├── Build
│   └── HashJoin: INNER
│       ├── Build
│       │   └── Scan: default.join_reorder.t (read rows: 1)
│       └── Probe
│           └── Scan: default.join_reorder.t1 (read rows: 10)
└── Probe
    └── Scan: default.join_reorder.t2 (read rows: 100)

query T
explain join select * from t2, t1, t where t.a = t2.a and t1.a = t2.a
----
HashJoin: INNER
├── Build
│   └── HashJoin: INNER
│       ├── Build
│       │   └── Scan: default.join_reorder.t (read rows: 1)
│       └── Probe
│           └── Scan: default.join_reorder.t1 (read rows: 10)
└── Probe
    └── Scan: default.join_reorder.t2 (read rows: 100)

query T
explain join select * from t2, t, t1 where t.a = t2.a and t1.a = t2.a
----
HashJoin: INNER
├── Build
│   └── HashJoin: INNER
│       ├── Build
│       │   └── Scan: default.join_reorder.t (read rows: 1)
│       └── Probe
│           └── Scan: default.join_reorder.t1 (read rows: 10)
└── Probe
    └── Scan: default.join_reorder.t2 (read rows: 100)

statement ok
drop database join_reorder
